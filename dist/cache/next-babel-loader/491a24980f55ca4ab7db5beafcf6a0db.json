{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ruala\\\\Desktop\\\\ASahak\\\\daser\\\\next\\\\CryptoGraphy\\\\components\\\\Messages.jsx\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport { connect } from \"react-redux\";\nimport { __GET_ACTIVE_USERS_MESSAGES, __ADD_MESSAGE, __GET_CHAT_USERS, __IS_TYPING_TO_ACTIVE_USER, __EDIT_MESSAGE } from 'store/saga';\nimport { __SET_ENCRYPT_DATA } from 'store/actions';\nimport TextAreaMessage from 'components/elements/TextAreaMessage';\nimport Skeleton from \"./Skeleton\";\nimport PrivateMessageContent from \"components/elements/PrivateMessageContent\";\nimport { Modal } from 'components/shared/UI/Modal';\nimport UI_ELEMENTS from \"./shared/UI\";\nimport { Bus } from \"components/shared/helpers/Bus\";\nimport { Vigenere, RSA, Caesar, Playfair, Vernam, Substitution } from 'libraries';\n\nclass Messages extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      startMessageNotify: '',\n      skeletonLoading: true,\n      noChatUser: false,\n      activeUserData: {},\n      showModal: false,\n      beforeClose: false,\n      sendMessage: '',\n      modalData: {\n        yourMessage: '',\n        encryptText: '',\n        warningMsg: ''\n      }\n    };\n    this.__sendMessage = this.__sendMessage.bind(this);\n    this.__isTyping = this.__isTyping.bind(this);\n    this.__handleSuccess = this.__handleSuccess.bind(this);\n    this.__closeModal = this.__closeModal.bind(this);\n    this.__handleSubmitMessage = this.__handleSubmitMessage.bind(this);\n    this.__updateStateContent = this.__updateStateContent.bind(this);\n    this.__messagesHaveBeenDeleted = this.__messagesHaveBeenDeleted.bind(this);\n  }\n\n  async componentDidUpdate(prevProps, prevState, snapshot) {\n    var _prevProps$activeUser, _this$props$activeUse, _prevProps$activeUser2, _this$props$activeUse2, _prevProps$activeUser3, _this$props$activeUse4, _this$props$activeUse5;\n\n    // Working when my chat list is empty\n    if (!this.state.noChatUser && this.props.usersList && this.props.usersList.length === 0) {\n      this.setState({\n        noChatUser: true\n      });\n    } else if (this.state.noChatUser && this.props.usersList && this.props.usersList.length !== 0) {\n      this.setState({\n        noChatUser: false\n      });\n    }\n\n    if (!((_prevProps$activeUser = prevProps.activeUser) === null || _prevProps$activeUser === void 0 ? void 0 : _prevProps$activeUser.id) && ((_this$props$activeUse = this.props.activeUser) === null || _this$props$activeUse === void 0 ? void 0 : _this$props$activeUse.id) && ((_prevProps$activeUser2 = prevProps.activeUser) === null || _prevProps$activeUser2 === void 0 ? void 0 : _prevProps$activeUser2.id) !== ((_this$props$activeUse2 = this.props.activeUser) === null || _this$props$activeUse2 === void 0 ? void 0 : _this$props$activeUse2.id)) {\n      var _this$props$activeUse3;\n\n      this.setState({\n        startMessageNotify: '',\n        skeletonLoading: true\n      });\n      const startTime = new Date().getTime();\n      const genMessages = await __GET_ACTIVE_USERS_MESSAGES((_this$props$activeUse3 = this.props.activeUser) === null || _this$props$activeUse3 === void 0 ? void 0 : _this$props$activeUse3.id).next();\n      const endTime = new Date().getTime();\n\n      this.__updateStateContent(genMessages.value.letters[0].message, endTime, startTime);\n    } else if (((_prevProps$activeUser3 = prevProps.activeUser) === null || _prevProps$activeUser3 === void 0 ? void 0 : _prevProps$activeUser3.id) !== ((_this$props$activeUse4 = this.props.activeUser) === null || _this$props$activeUse4 === void 0 ? void 0 : _this$props$activeUse4.id) && ((_this$props$activeUse5 = this.props.activeUser) === null || _this$props$activeUse5 === void 0 ? void 0 : _this$props$activeUse5.id)) {\n      var _this$props$activeUse6;\n\n      this.setState({\n        startMessageNotify: '',\n        skeletonLoading: true\n      });\n      const startTime = new Date().getTime();\n      const genMessages = await __GET_ACTIVE_USERS_MESSAGES((_this$props$activeUse6 = this.props.activeUser) === null || _this$props$activeUse6 === void 0 ? void 0 : _this$props$activeUse6.id).next();\n      const endTime = new Date().getTime();\n\n      this.__updateStateContent(genMessages.value.letters[0].message, endTime, startTime);\n    } else if (prevProps.messages.length === 1 && prevProps.messages[0].message === '' && this.props.messages.length === 1 && this.props.messages[0].message !== '') {\n      this.setState({\n        startMessageNotify: ''\n      });\n    }\n  }\n\n  __messagesHaveBeenDeleted() {\n    this.setState({\n      startMessageNotify: 'Send the first letter'\n    });\n  }\n\n  __updateStateContent(message, endTime, startTime) {\n    this.setState(_objectSpread({}, message === '' && {\n      startMessageNotify: 'Send the first letter'\n    }));\n\n    if (endTime - startTime < 1000) {\n      setTimeout(() => {\n        this.setState({\n          noChatUser: false,\n          skeletonLoading: false\n        });\n      }, 1000);\n    } else {\n      this.setState({\n        noChatUser: false,\n        skeletonLoading: false\n      });\n    }\n  }\n\n  __isTyping(hint) {\n    var _this$props$activeUse7;\n\n    __IS_TYPING_TO_ACTIVE_USER(hint, (_this$props$activeUse7 = this.props.activeUser) === null || _this$props$activeUse7 === void 0 ? void 0 : _this$props$activeUse7.id, this.props.loggedUser.id).next();\n  }\n\n  __handleSuccess() {\n    this.setState({\n      beforeClose: true\n    });\n  }\n\n  __closeModal() {\n    this.setState({\n      beforeClose: false,\n      showModal: false\n    }, () => {\n      if (this.state.modalData.encryptText) this.__handleSubmitMessage(this.state.sendMessage, this.state.modalData.encryptText, this.state.modalData.decryptText);\n    });\n  }\n\n  async __handleSubmitMessage(value, encryptedMsg, decryptMsg) {\n    var _this$props$encryptDa, _this$props$activeUse8, _this$props$activeUse9;\n\n    const isKey = value === 'crypt' && value === encryptedMsg && value === decryptMsg && isNaN(decryptMsg);\n    const messageData = {\n      time: new Date().getTime(),\n      message: value,\n      encryptedMsg: encryptedMsg,\n      decryptedMsg: decryptMsg,\n      key: isKey ? 'crypt' : (_this$props$encryptDa = this.props.encryptData) === null || _this$props$encryptDa === void 0 ? void 0 : _this$props$encryptDa.key,\n      encryptType: isKey ? 'crypt' : this.props.encryptData.type\n    };\n    await __ADD_MESSAGE({\n      friend: {\n        friendId: (_this$props$activeUse8 = this.props.activeUser) === null || _this$props$activeUse8 === void 0 ? void 0 : _this$props$activeUse8.id,\n        loggedUser: this.props.loggedUser,\n        msgData: _objectSpread({}, messageData, {\n          owner: this.props.loggedUser.id\n        })\n      },\n      my: {\n        friendId: (_this$props$activeUse9 = this.props.activeUser) === null || _this$props$activeUse9 === void 0 ? void 0 : _this$props$activeUse9.id,\n        loggedUser: this.props.loggedUser,\n        msgData: _objectSpread({}, messageData, {\n          owner: 'Me'\n        })\n      }\n    }).next();\n\n    __GET_CHAT_USERS().next();\n\n    this.setState({\n      startMessageNotify: ''\n    });\n    Bus.dispatch('messageSendingFinish');\n  }\n\n  __encryptCommon(value, key, type, callback = () => {}) {\n    let sendMSG = {};\n\n    switch (type) {\n      case 'vigenere':\n        const encryptedMsgV = Vigenere.doCryptVigenere(false, value, key, msg => {\n          callback(msg);\n\n          this.props.__SET_ENCRYPT_DATA({\n            type: 'warning',\n            value: true\n          });\n        });\n        return sendMSG = {\n          encryptedMSG: encryptedMsgV,\n          decryptedMSG: Vigenere.doCryptVigenere(true, encryptedMsgV, key, msg => {\n            callback(msg);\n\n            this.props.__SET_ENCRYPT_DATA({\n              type: 'warning',\n              value: true\n            });\n          })\n        };\n\n      case 'substitution':\n        const encryptedMsgS = Substitution(value);\n        return sendMSG = {\n          encryptedMSG: encryptedMsgS.encrypt,\n          decryptedMSG: encryptedMsgS.decrypt\n        };\n\n      case 'rsa':\n        // Message\n        const message = value; // Generate RSA keys\n\n        const keys = RSA.generate(key);\n        const encoded_message = RSA.encode(message);\n        const encrypted_message = RSA.encrypt(encoded_message, keys.n, keys.e);\n        const decrypted_message = RSA.decrypt(encrypted_message, keys.d, keys.n);\n        const decoded_message = RSA.decode(decrypted_message);\n        return sendMSG = {\n          encryptedMSG: encoded_message.toString(),\n          decryptedMSG: decoded_message\n        };\n\n      case 'caesar':\n        const encryptedMsgC = Caesar.doCrypt(false, value, key, msg => {\n          callback(msg);\n        });\n        return sendMSG = {\n          encryptedMSG: encryptedMsgC,\n          decryptedMSG: Caesar.doCrypt(true, encryptedMsgC, key, msg => {\n            callback(msg);\n          })\n        };\n\n      case 'playfair':\n        return sendMSG = {\n          encryptedMSG: Playfair.doCipher(value, key, msg => {\n            callback(msg);\n          }),\n          decryptedMSG: Playfair.deCodeCipher(value, key)\n        };\n\n      case 'vernam':\n        let _keyE = '';\n        const encryptedMsgVer = Vernam.doEncrypt(value, _key => {\n          _keyE = _key;\n\n          this.props.__SET_ENCRYPT_DATA({\n            type: 'key',\n            value: _key\n          });\n        });\n        return sendMSG = {\n          encryptedMSG: encryptedMsgVer,\n          decryptedMSG: Vernam.doDecrypt(value, _keyE)\n        };\n\n      default:\n        break;\n    }\n  }\n\n  async __sendMessage(value, isKey) {\n    if (isKey instanceof Object) {\n      var _isKey$mainObj, _isKey$mainObj2, _this$props$activeUse10, _this$props$loggedUse;\n\n      const encryptedMsg = this.__encryptCommon.call(this, value, (_isKey$mainObj = isKey.mainObj) === null || _isKey$mainObj === void 0 ? void 0 : _isKey$mainObj.key, (_isKey$mainObj2 = isKey.mainObj) === null || _isKey$mainObj2 === void 0 ? void 0 : _isKey$mainObj2.encryptType);\n\n      await __EDIT_MESSAGE({\n        value,\n        e: encryptedMsg.encryptedMSG,\n        d: encryptedMsg.decryptedMSG\n      }, isKey === null || isKey === void 0 ? void 0 : isKey.index, {\n        idUser: (_this$props$activeUse10 = this.props.activeUser) === null || _this$props$activeUse10 === void 0 ? void 0 : _this$props$activeUse10.id,\n        myId: (_this$props$loggedUse = this.props.loggedUser) === null || _this$props$loggedUse === void 0 ? void 0 : _this$props$loggedUse.id\n      }).next();\n      Bus.dispatch('endEditing');\n      Bus.dispatch('messageSendingFinish');\n      return;\n    } else if (isKey) {\n      this.__handleSubmitMessage('crypt', 'crypt', 'crypt');\n\n      return;\n    }\n\n    let warning = '';\n    this.setState({\n      sendMessage: value\n    }, () => {\n      var _this$props$encryptDa2;\n\n      const encryptMsg = this.__encryptCommon.call(this, value, (_this$props$encryptDa2 = this.props.encryptData) === null || _this$props$encryptDa2 === void 0 ? void 0 : _this$props$encryptDa2.key, this.props.encryptData.type, msg => {\n        warning = msg;\n      });\n\n      if (this.props.isShowModal) {\n        this.setState({\n          modalData: _objectSpread({\n            yourMessage: value\n          }, warning && {\n            warningMsg: warning\n          }, {}, encryptMsg.encryptedMSG && {\n            encryptText: encryptMsg.encryptedMSG\n          }, {}, encryptMsg.decryptedMSG && {\n            decryptText: encryptMsg.decryptedMSG\n          }),\n          showModal: true\n        });\n      } else if (encryptMsg.encryptedMSG && encryptMsg.decryptedMSG) this.__handleSubmitMessage(value, encryptMsg.encryptedMSG, encryptMsg.decryptedMSG);\n    });\n  }\n\n  render() {\n    var _this$props$loggedUse2;\n\n    return __jsx(\"div\", {\n      className: \"jsx-610849184\" + \" \" + `message-content-right \n                ${this.state.skeletonLoading ? 'skeleton-loading-content' : ''} \n                ${!this.state.noChatUser ? 'hidden-overlay' : ''} \n                ${this.state.startMessageNotify ? 'empty-message-content' : ''}\n                ${this.state.noChatUser ? 'no-chat-user' : ''}\n                `,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 13\n      }\n    }, this.state.skeletonLoading && !this.state.noChatUser ? new Array(6).fill('').map((_, i) => {\n      return __jsx(\"div\", {\n        key: i + Math.random().toString(16).slice(2, 6),\n        style: {\n          opacity: (6 - i) * 0.10\n        },\n        className: \"jsx-610849184\" + \" \" + `skeleton-container-messages ${i % 2 !== 0 ? 'odd-container-skeleton' : ''}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 33\n        }\n      }, __jsx(Skeleton, {\n        width: \"35px\",\n        height: \"35px\",\n        margin: ['5px', '10px', '0px', '10px'],\n        radius: \"50%\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 37\n        }\n      }), __jsx(\"div\", {\n        className: \"jsx-610849184\" + \" \" + \"line-wrap\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 37\n        }\n      }, __jsx(Skeleton, {\n        width: \"55%\",\n        height: \"52px\",\n        margin: ['5px', '0px', '0px', i % 2 !== 0 ? 'auto' : '0px'],\n        radius: \"0%\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 41\n        }\n      }), i % 2 !== 0 ? __jsx(Skeleton, {\n        width: \"55%\",\n        height: \"52px\",\n        margin: ['5px', '0px', '0px', 'auto'],\n        radius: \"0%\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 45\n        }\n      }) : ''));\n    }) : this.state.startMessageNotify ? __jsx(\"div\", {\n      className: \"jsx-610849184\" + \" \" + \"send-first-message\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 55\n      }\n    }, this.state.startMessageNotify) : !this.state.noChatUser && __jsx(PrivateMessageContent, {\n      messagesHaveBeenDeleted: this.__messagesHaveBeenDeleted,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 21\n      }\n    }), !this.state.skeletonLoading && __jsx(TextAreaMessage, {\n      activeUser: this.props.activeUser,\n      loggedUserId: (_this$props$loggedUse2 = this.props.loggedUser) === null || _this$props$loggedUse2 === void 0 ? void 0 : _this$props$loggedUse2.id,\n      isTyping: this.__isTyping,\n      sendMessage: this.__sendMessage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 49\n      }\n    }), __jsx(Modal, {\n      show: this.state.showModal,\n      beforeClose: this.state.beforeClose,\n      close: this.__closeModal,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 17\n      }\n    }, __jsx(\"div\", {\n      className: \"jsx-610849184\" + \" \" + \"scroll-content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 21\n      }\n    }, __jsx(\"h2\", {\n      className: \"jsx-610849184\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 25\n      }\n    }, \"Please confirm message\"), __jsx(\"h4\", {\n      className: \"jsx-610849184\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 25\n      }\n    }, \"Your included text\"), __jsx(\"p\", {\n      className: \"jsx-610849184\" + \" \" + \"message-p\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 25\n      }\n    }, this.state.modalData.yourMessage), __jsx(\"h4\", {\n      className: \"jsx-610849184\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 25\n      }\n    }, \"Encrypted text\"), this.state.modalData.warningMsg ? __jsx(\"p\", {\n      className: \"jsx-610849184\" + \" \" + \"warning-message\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 60\n      }\n    }, this.state.modalData.warningMsg) : __jsx(\"p\", {\n      className: \"jsx-610849184\" + \" \" + \"message-p\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 29\n      }\n    }, this.state.modalData.encryptText)), __jsx(UI_ELEMENTS.Button, {\n      background: \"#37415c\",\n      color: \"#fff\",\n      fontSize: 11,\n      type: \"button\",\n      text: 'Send',\n      width: 100,\n      margin: ['20px', '0', '0', 'auto'],\n      onClick: this.__handleSuccess,\n      size: \"sm\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 21\n      }\n    })), __jsx(_JSXStyle, {\n      id: \"610849184\",\n      __self: this\n    }, \".scroll-content.jsx-610849184{max-height:70vh;overflow-x:hidden;}.message-p.jsx-610849184{word-break:break-all;}.warning-message.jsx-610849184{color:#ffa100;}.skeleton-container-messages.jsx-610849184 .line-wrap.jsx-610849184{width:calc(100% - 70px);margin-bottom:10px;}.odd-container-skeleton.jsx-610849184{-webkit-flex-direction:row-reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;}.skeleton-container-messages.jsx-610849184{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.message-content-right.hidden-overlay.jsx-610849184{overflow:hidden;}.message-content-right.skeleton-loading-content.jsx-610849184{overflow:hidden;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;}.message-content-right.jsx-610849184{height:calc(100% - 42px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}.empty-message-content.jsx-610849184{-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;}.send-first-message.jsx-610849184{text-align:center;font-size:20px;margin-bottom:16px;}.no-chat-user.jsx-610849184{background-image:url('./assets/images/nochat.png');background-position:center;background-repeat:no-repeat;opacity:.2;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xccnVhbGFcXERlc2t0b3BcXEFTYWhha1xcZGFzZXJcXG5leHRcXENyeXB0b0dyYXBoeVxcY29tcG9uZW50c1xcTWVzc2FnZXMuanN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQXlWNkIsQUFHeUMsQUFJSyxBQUdQLEFBR1UsQUFJRyxBQUdkLEFBR0csQUFHQSxBQUlTLEFBTUEsQUFHUCxBQUtpQyxjQWpDdkQsRUFQc0IsQUFvQnRCLEFBRytCLEVBYVosR0FoQ25CLEdBTXVCLENBaUJOLFFBVU0sQ0FwQ3ZCLFNBVUEsUUE4QitCLENBSC9CLHNCQXJCQSxJQXlCZ0MsZUE1QmhDLElBbUJBLEVBTDBCLE9BZVgsV0FDZixJQXBCQSx3REFLa0MsbUhBQ2xDIiwiZmlsZSI6IkM6XFxVc2Vyc1xccnVhbGFcXERlc2t0b3BcXEFTYWhha1xcZGFzZXJcXG5leHRcXENyeXB0b0dyYXBoeVxcY29tcG9uZW50c1xcTWVzc2FnZXMuanN4Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHtjb25uZWN0fSBmcm9tIFwicmVhY3QtcmVkdXhcIjtcclxuaW1wb3J0IHtcclxuICAgIF9fR0VUX0FDVElWRV9VU0VSU19NRVNTQUdFUyxcclxuICAgIF9fQUREX01FU1NBR0UsXHJcbiAgICBfX0dFVF9DSEFUX1VTRVJTLFxyXG4gICAgX19JU19UWVBJTkdfVE9fQUNUSVZFX1VTRVIsXHJcbiAgICBfX0VESVRfTUVTU0FHRSxcclxufSBmcm9tICdzdG9yZS9zYWdhJztcclxuaW1wb3J0IHtcclxuICAgIF9fU0VUX0VOQ1JZUFRfREFUQSxcclxufSBmcm9tICdzdG9yZS9hY3Rpb25zJztcclxuaW1wb3J0IFRleHRBcmVhTWVzc2FnZSBmcm9tICdjb21wb25lbnRzL2VsZW1lbnRzL1RleHRBcmVhTWVzc2FnZSc7XHJcbmltcG9ydCBTa2VsZXRvbiBmcm9tIFwiLi9Ta2VsZXRvblwiO1xyXG5pbXBvcnQgUHJpdmF0ZU1lc3NhZ2VDb250ZW50IGZyb20gXCJjb21wb25lbnRzL2VsZW1lbnRzL1ByaXZhdGVNZXNzYWdlQ29udGVudFwiO1xyXG5pbXBvcnQgeyBNb2RhbCB9IGZyb20gJ2NvbXBvbmVudHMvc2hhcmVkL1VJL01vZGFsJztcclxuaW1wb3J0IFVJX0VMRU1FTlRTIGZyb20gXCIuL3NoYXJlZC9VSVwiO1xyXG5pbXBvcnQgeyBCdXMgfSBmcm9tIFwiY29tcG9uZW50cy9zaGFyZWQvaGVscGVycy9CdXNcIjtcclxuaW1wb3J0IHtcclxuICAgIFZpZ2VuZXJlLFxyXG4gICAgUlNBLFxyXG4gICAgQ2Flc2FyLFxyXG4gICAgUGxheWZhaXIsXHJcbiAgICBWZXJuYW0sXHJcbiAgICBTdWJzdGl0dXRpb24sXHJcbn0gZnJvbSAnbGlicmFyaWVzJztcclxuXHJcblxyXG5jbGFzcyBNZXNzYWdlcyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3RvciAocHJvcHMpIHtcclxuICAgICAgICBzdXBlcihwcm9wcyk7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgICAgICAgc3RhcnRNZXNzYWdlTm90aWZ5OiAnJyxcclxuICAgICAgICAgICAgc2tlbGV0b25Mb2FkaW5nOiB0cnVlLFxyXG4gICAgICAgICAgICBub0NoYXRVc2VyOiBmYWxzZSxcclxuICAgICAgICAgICAgYWN0aXZlVXNlckRhdGE6IHt9LFxyXG4gICAgICAgICAgICBzaG93TW9kYWw6IGZhbHNlLFxyXG4gICAgICAgICAgICBiZWZvcmVDbG9zZTogZmFsc2UsXHJcbiAgICAgICAgICAgIHNlbmRNZXNzYWdlOiAnJyxcclxuICAgICAgICAgICAgbW9kYWxEYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB5b3VyTWVzc2FnZTogJycsXHJcbiAgICAgICAgICAgICAgICBlbmNyeXB0VGV4dDogJycsXHJcbiAgICAgICAgICAgICAgICB3YXJuaW5nTXNnOiAnJyxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fX3NlbmRNZXNzYWdlICAgICAgICAgICAgICA9IHRoaXMuX19zZW5kTWVzc2FnZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuX19pc1R5cGluZyAgICAgICAgICAgICAgICAgPSB0aGlzLl9faXNUeXBpbmcuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLl9faGFuZGxlU3VjY2VzcyAgICAgICAgICAgID0gdGhpcy5fX2hhbmRsZVN1Y2Nlc3MuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLl9fY2xvc2VNb2RhbCAgICAgICAgICAgICAgID0gdGhpcy5fX2Nsb3NlTW9kYWwuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLl9faGFuZGxlU3VibWl0TWVzc2FnZSAgICAgID0gdGhpcy5fX2hhbmRsZVN1Ym1pdE1lc3NhZ2UuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLl9fdXBkYXRlU3RhdGVDb250ZW50ICAgICAgID0gdGhpcy5fX3VwZGF0ZVN0YXRlQ29udGVudC5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuX19tZXNzYWdlc0hhdmVCZWVuRGVsZXRlZCAgPSB0aGlzLl9fbWVzc2FnZXNIYXZlQmVlbkRlbGV0ZWQuYmluZCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzLCBwcmV2U3RhdGUsIHNuYXBzaG90KSB7XHJcbiAgICAgICAgLy8gV29ya2luZyB3aGVuIG15IGNoYXQgbGlzdCBpcyBlbXB0eVxyXG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5ub0NoYXRVc2VyICYmIHRoaXMucHJvcHMudXNlcnNMaXN0ICYmIHRoaXMucHJvcHMudXNlcnNMaXN0Lmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgIG5vQ2hhdFVzZXI6IHRydWVcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdGUubm9DaGF0VXNlciAmJiB0aGlzLnByb3BzLnVzZXJzTGlzdCAmJiB0aGlzLnByb3BzLnVzZXJzTGlzdC5sZW5ndGggIT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgICAgICBub0NoYXRVc2VyOiBmYWxzZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXByZXZQcm9wcy5hY3RpdmVVc2VyPy5pZCAmJiB0aGlzLnByb3BzLmFjdGl2ZVVzZXI/LmlkICYmIHByZXZQcm9wcy5hY3RpdmVVc2VyPy5pZCAhPT0gdGhpcy5wcm9wcy5hY3RpdmVVc2VyPy5pZCkge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0TWVzc2FnZU5vdGlmeTogJycsXHJcbiAgICAgICAgICAgICAgICBza2VsZXRvbkxvYWRpbmc6IHRydWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgICAgICAgICBjb25zdCBnZW5NZXNzYWdlcyA9IGF3YWl0IF9fR0VUX0FDVElWRV9VU0VSU19NRVNTQUdFUyh0aGlzLnByb3BzLmFjdGl2ZVVzZXI/LmlkKS5uZXh0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgICAgICAgICAgdGhpcy5fX3VwZGF0ZVN0YXRlQ29udGVudChnZW5NZXNzYWdlcy52YWx1ZS5sZXR0ZXJzWzBdLm1lc3NhZ2UsIGVuZFRpbWUsIHN0YXJ0VGltZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwcmV2UHJvcHMuYWN0aXZlVXNlcj8uaWQgIT09IHRoaXMucHJvcHMuYWN0aXZlVXNlcj8uaWQgJiYgdGhpcy5wcm9wcy5hY3RpdmVVc2VyPy5pZCkge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0TWVzc2FnZU5vdGlmeTogJycsXHJcbiAgICAgICAgICAgICAgICBza2VsZXRvbkxvYWRpbmc6IHRydWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgICAgICAgICBjb25zdCBnZW5NZXNzYWdlcyA9IGF3YWl0IF9fR0VUX0FDVElWRV9VU0VSU19NRVNTQUdFUyh0aGlzLnByb3BzLmFjdGl2ZVVzZXI/LmlkKS5uZXh0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX191cGRhdGVTdGF0ZUNvbnRlbnQoZ2VuTWVzc2FnZXMudmFsdWUubGV0dGVyc1swXS5tZXNzYWdlLCBlbmRUaW1lLCBzdGFydFRpbWUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocHJldlByb3BzLm1lc3NhZ2VzLmxlbmd0aCA9PT0gMSAmJiBwcmV2UHJvcHMubWVzc2FnZXNbMF0ubWVzc2FnZSA9PT0gJycgJiYgdGhpcy5wcm9wcy5tZXNzYWdlcy5sZW5ndGggPT09IDEgJiYgdGhpcy5wcm9wcy5tZXNzYWdlc1swXS5tZXNzYWdlICE9PSAnJykge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0TWVzc2FnZU5vdGlmeTogJycsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfX21lc3NhZ2VzSGF2ZUJlZW5EZWxldGVkICgpIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgc3RhcnRNZXNzYWdlTm90aWZ5OiAnU2VuZCB0aGUgZmlyc3QgbGV0dGVyJ1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgX191cGRhdGVTdGF0ZUNvbnRlbnQgKG1lc3NhZ2UsIGVuZFRpbWUsIHN0YXJ0VGltZSkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoey8vSWYgdGhlcmUgYXJlbid0IGFueSBtZXNzYWdlc1xyXG4gICAgICAgICAgICAuLi4obWVzc2FnZSA9PT0gJycgJiYge3N0YXJ0TWVzc2FnZU5vdGlmeTogJ1NlbmQgdGhlIGZpcnN0IGxldHRlcid9KVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoZW5kVGltZSAtIHN0YXJ0VGltZSA8IDEwMDApIHtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBub0NoYXRVc2VyOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBza2VsZXRvbkxvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSwgMTAwMClcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgIG5vQ2hhdFVzZXI6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgc2tlbGV0b25Mb2FkaW5nOiBmYWxzZSxcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX19pc1R5cGluZyAoaGludCkge1xyXG4gICAgICAgIF9fSVNfVFlQSU5HX1RPX0FDVElWRV9VU0VSKGhpbnQsIHRoaXMucHJvcHMuYWN0aXZlVXNlcj8uaWQsIHRoaXMucHJvcHMubG9nZ2VkVXNlci5pZCkubmV4dCgpXHJcbiAgICB9XHJcblxyXG4gICAgX19oYW5kbGVTdWNjZXNzICgpIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgYmVmb3JlQ2xvc2U6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBfX2Nsb3NlTW9kYWwgKCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBiZWZvcmVDbG9zZTogZmFsc2UsXHJcbiAgICAgICAgICAgIHNob3dNb2RhbDogZmFsc2VcclxuICAgICAgICB9LCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLm1vZGFsRGF0YS5lbmNyeXB0VGV4dCkgdGhpcy5fX2hhbmRsZVN1Ym1pdE1lc3NhZ2UodGhpcy5zdGF0ZS5zZW5kTWVzc2FnZSwgdGhpcy5zdGF0ZS5tb2RhbERhdGEuZW5jcnlwdFRleHQsIHRoaXMuc3RhdGUubW9kYWxEYXRhLmRlY3J5cHRUZXh0KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBfX2hhbmRsZVN1Ym1pdE1lc3NhZ2UgKHZhbHVlLCBlbmNyeXB0ZWRNc2csIGRlY3J5cHRNc2cpIHtcclxuICAgICAgICBjb25zdCBpc0tleSA9ICh2YWx1ZSA9PT0gJ2NyeXB0JyAmJiB2YWx1ZSA9PT0gZW5jcnlwdGVkTXNnICYmIHZhbHVlID09PSBkZWNyeXB0TXNnICYmIChpc05hTihkZWNyeXB0TXNnKSkpO1xyXG4gICAgICAgIGNvbnN0IG1lc3NhZ2VEYXRhID0ge1xyXG4gICAgICAgICAgICB0aW1lOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcclxuICAgICAgICAgICAgbWVzc2FnZTogdmFsdWUsXHJcbiAgICAgICAgICAgIGVuY3J5cHRlZE1zZzogZW5jcnlwdGVkTXNnLFxyXG4gICAgICAgICAgICBkZWNyeXB0ZWRNc2c6IGRlY3J5cHRNc2csXHJcbiAgICAgICAgICAgIGtleTogaXNLZXkgPyAnY3J5cHQnIDogdGhpcy5wcm9wcy5lbmNyeXB0RGF0YT8ua2V5LFxyXG4gICAgICAgICAgICBlbmNyeXB0VHlwZTogaXNLZXkgPyAnY3J5cHQnIDogdGhpcy5wcm9wcy5lbmNyeXB0RGF0YS50eXBlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgYXdhaXQgX19BRERfTUVTU0FHRSh7XHJcbiAgICAgICAgICAgIGZyaWVuZDoge1xyXG4gICAgICAgICAgICAgICAgZnJpZW5kSWQ6IHRoaXMucHJvcHMuYWN0aXZlVXNlcj8uaWQsXHJcbiAgICAgICAgICAgICAgICBsb2dnZWRVc2VyOiB0aGlzLnByb3BzLmxvZ2dlZFVzZXIsXHJcbiAgICAgICAgICAgICAgICBtc2dEYXRhOiB7Li4ubWVzc2FnZURhdGEsIG93bmVyOiB0aGlzLnByb3BzLmxvZ2dlZFVzZXIuaWR9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG15OiB7XHJcbiAgICAgICAgICAgICAgICBmcmllbmRJZDogdGhpcy5wcm9wcy5hY3RpdmVVc2VyPy5pZCxcclxuICAgICAgICAgICAgICAgIGxvZ2dlZFVzZXI6IHRoaXMucHJvcHMubG9nZ2VkVXNlcixcclxuICAgICAgICAgICAgICAgIG1zZ0RhdGE6IHsuLi5tZXNzYWdlRGF0YSwgb3duZXI6ICdNZSd9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5uZXh0KCk7XHJcblxyXG4gICAgICAgIF9fR0VUX0NIQVRfVVNFUlMoKS5uZXh0KCk7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIHN0YXJ0TWVzc2FnZU5vdGlmeTogJydcclxuICAgICAgICB9KTtcclxuICAgICAgICBCdXMuZGlzcGF0Y2goJ21lc3NhZ2VTZW5kaW5nRmluaXNoJyk7XHJcbiAgICB9XHJcblxyXG4gICAgX19lbmNyeXB0Q29tbW9uICh2YWx1ZSwga2V5LCB0eXBlLCBjYWxsYmFjayA9ICgpID0+IHt9KSB7XHJcbiAgICAgICAgbGV0IHNlbmRNU0cgPSB7fTtcclxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSAndmlnZW5lcmUnOlxyXG4gICAgICAgICAgICAgICAgY29uc3QgZW5jcnlwdGVkTXNnViA9IFZpZ2VuZXJlLmRvQ3J5cHRWaWdlbmVyZShmYWxzZSwgdmFsdWUsIGtleSwgKG1zZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKG1zZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5fX1NFVF9FTkNSWVBUX0RBVEEoe3R5cGU6ICd3YXJuaW5nJywgdmFsdWU6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbmRNU0cgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW5jcnlwdGVkTVNHOiBlbmNyeXB0ZWRNc2dWLFxyXG4gICAgICAgICAgICAgICAgICAgIGRlY3J5cHRlZE1TRzogVmlnZW5lcmUuZG9DcnlwdFZpZ2VuZXJlKHRydWUsIGVuY3J5cHRlZE1zZ1YsIGtleSwgKG1zZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhtc2cpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLl9fU0VUX0VOQ1JZUFRfREFUQSh7dHlwZTogJ3dhcm5pbmcnLCB2YWx1ZTogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY2FzZSAnc3Vic3RpdHV0aW9uJyA6XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlbmNyeXB0ZWRNc2dTID0gU3Vic3RpdHV0aW9uKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZW5kTVNHID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGVuY3J5cHRlZE1TRzogZW5jcnlwdGVkTXNnUy5lbmNyeXB0LFxyXG4gICAgICAgICAgICAgICAgICAgIGRlY3J5cHRlZE1TRzogZW5jcnlwdGVkTXNnUy5kZWNyeXB0XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjYXNlICdyc2EnIDpcclxuICAgICAgICAgICAgICAgIC8vIE1lc3NhZ2VcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB2YWx1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBHZW5lcmF0ZSBSU0Ega2V5c1xyXG4gICAgICAgICAgICAgICAgY29uc3Qga2V5cyA9IFJTQS5nZW5lcmF0ZShrZXkpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGVuY29kZWRfbWVzc2FnZSA9IFJTQS5lbmNvZGUobWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlbmNyeXB0ZWRfbWVzc2FnZSA9IFJTQS5lbmNyeXB0KGVuY29kZWRfbWVzc2FnZSwga2V5cy5uLCBrZXlzLmUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVjcnlwdGVkX21lc3NhZ2UgPSBSU0EuZGVjcnlwdChlbmNyeXB0ZWRfbWVzc2FnZSwga2V5cy5kLCBrZXlzLm4pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVjb2RlZF9tZXNzYWdlID0gUlNBLmRlY29kZShkZWNyeXB0ZWRfbWVzc2FnZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbmRNU0cgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW5jcnlwdGVkTVNHOiBlbmNvZGVkX21lc3NhZ2UudG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgICAgICBkZWNyeXB0ZWRNU0c6IGRlY29kZWRfbWVzc2FnZVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY2FzZSAnY2Flc2FyJzpcclxuICAgICAgICAgICAgICAgIGNvbnN0IGVuY3J5cHRlZE1zZ0MgPSBDYWVzYXIuZG9DcnlwdChmYWxzZSwgdmFsdWUsIGtleSwgKG1zZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKG1zZyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZW5kTVNHID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGVuY3J5cHRlZE1TRzogZW5jcnlwdGVkTXNnQyxcclxuICAgICAgICAgICAgICAgICAgICBkZWNyeXB0ZWRNU0c6IENhZXNhci5kb0NyeXB0KHRydWUsIGVuY3J5cHRlZE1zZ0MsIGtleSwgKG1zZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhtc2cpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjYXNlICdwbGF5ZmFpcic6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VuZE1TRyA9IHtcclxuICAgICAgICAgICAgICAgICAgICBlbmNyeXB0ZWRNU0c6IFBsYXlmYWlyLmRvQ2lwaGVyKHZhbHVlLCBrZXksIChtc2cpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sobXNnKTtcclxuICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgICAgICBkZWNyeXB0ZWRNU0c6IFBsYXlmYWlyLmRlQ29kZUNpcGhlcih2YWx1ZSwga2V5KVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY2FzZSAndmVybmFtJzpcclxuICAgICAgICAgICAgICAgIGxldCBfa2V5RSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZW5jcnlwdGVkTXNnVmVyID0gVmVybmFtLmRvRW5jcnlwdCh2YWx1ZSwgKF9rZXkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBfa2V5RSA9IF9rZXk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5fX1NFVF9FTkNSWVBUX0RBVEEoe3R5cGU6ICdrZXknLCB2YWx1ZTogX2tleX0pXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VuZE1TRyA9IHtcclxuICAgICAgICAgICAgICAgICAgICBlbmNyeXB0ZWRNU0c6IGVuY3J5cHRlZE1zZ1ZlcixcclxuICAgICAgICAgICAgICAgICAgICBkZWNyeXB0ZWRNU0c6IFZlcm5hbS5kb0RlY3J5cHQodmFsdWUsIF9rZXlFKVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgZGVmYXVsdCA6IGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBfX3NlbmRNZXNzYWdlICh2YWx1ZSwgaXNLZXkpIHtcclxuICAgICAgICBpZiAoaXNLZXkgaW5zdGFuY2VvZiBPYmplY3QpIHtcclxuICAgICAgICAgICAgY29uc3QgZW5jcnlwdGVkTXNnID0gdGhpcy5fX2VuY3J5cHRDb21tb24uY2FsbCh0aGlzLCB2YWx1ZSwgaXNLZXkubWFpbk9iaj8ua2V5LCBpc0tleS5tYWluT2JqPy5lbmNyeXB0VHlwZSk7XHJcbiAgICAgICAgICAgIGF3YWl0IF9fRURJVF9NRVNTQUdFKFxyXG4gICAgICAgICAgICAgICAge3ZhbHVlLCBlOiBlbmNyeXB0ZWRNc2cuZW5jcnlwdGVkTVNHLCBkOiBlbmNyeXB0ZWRNc2cuZGVjcnlwdGVkTVNHfSxcclxuICAgICAgICAgICAgICAgIGlzS2V5Py5pbmRleCxcclxuICAgICAgICAgICAgICAgIHtpZFVzZXI6IHRoaXMucHJvcHMuYWN0aXZlVXNlcj8uaWQsIG15SWQ6IHRoaXMucHJvcHMubG9nZ2VkVXNlcj8uaWR9KS5uZXh0KCk7XHJcbiAgICAgICAgICAgIEJ1cy5kaXNwYXRjaCgnZW5kRWRpdGluZycpO1xyXG4gICAgICAgICAgICBCdXMuZGlzcGF0Y2goJ21lc3NhZ2VTZW5kaW5nRmluaXNoJyk7XHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH0gZWxzZSBpZiAoaXNLZXkpIHtcclxuICAgICAgICAgICAgdGhpcy5fX2hhbmRsZVN1Ym1pdE1lc3NhZ2UoJ2NyeXB0JywgJ2NyeXB0JywgJ2NyeXB0Jyk7XHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgd2FybmluZyA9ICcnO1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBzZW5kTWVzc2FnZTogdmFsdWVcclxuICAgICAgICB9LCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuY3J5cHRNc2cgPSB0aGlzLl9fZW5jcnlwdENvbW1vbi5jYWxsKHRoaXMsIHZhbHVlLCB0aGlzLnByb3BzLmVuY3J5cHREYXRhPy5rZXksIHRoaXMucHJvcHMuZW5jcnlwdERhdGEudHlwZSwgKG1zZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgd2FybmluZyA9IG1zZztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLmlzU2hvd01vZGFsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbERhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeW91ck1lc3NhZ2U6IHZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuLi4od2FybmluZyAmJiB7d2FybmluZ01zZzogd2FybmluZ30pLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuLi4oZW5jcnlwdE1zZy5lbmNyeXB0ZWRNU0cgJiYge2VuY3J5cHRUZXh0OiBlbmNyeXB0TXNnLmVuY3J5cHRlZE1TR30pLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuLi4oZW5jcnlwdE1zZy5kZWNyeXB0ZWRNU0cgJiYge2RlY3J5cHRUZXh0OiBlbmNyeXB0TXNnLmRlY3J5cHRlZE1TR30pLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2hvd01vZGFsOiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChlbmNyeXB0TXNnLmVuY3J5cHRlZE1TRyAmJiBlbmNyeXB0TXNnLmRlY3J5cHRlZE1TRykgdGhpcy5fX2hhbmRsZVN1Ym1pdE1lc3NhZ2UodmFsdWUsIGVuY3J5cHRNc2cuZW5jcnlwdGVkTVNHLCBlbmNyeXB0TXNnLmRlY3J5cHRlZE1TRyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyICgpIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BtZXNzYWdlLWNvbnRlbnQtcmlnaHQgXHJcbiAgICAgICAgICAgICAgICAke3RoaXMuc3RhdGUuc2tlbGV0b25Mb2FkaW5nID8gJ3NrZWxldG9uLWxvYWRpbmctY29udGVudCcgOiAnJ30gXHJcbiAgICAgICAgICAgICAgICAkeyF0aGlzLnN0YXRlLm5vQ2hhdFVzZXIgPyAnaGlkZGVuLW92ZXJsYXknIDogJyd9IFxyXG4gICAgICAgICAgICAgICAgJHt0aGlzLnN0YXRlLnN0YXJ0TWVzc2FnZU5vdGlmeSA/ICdlbXB0eS1tZXNzYWdlLWNvbnRlbnQnIDogJyd9XHJcbiAgICAgICAgICAgICAgICAke3RoaXMuc3RhdGUubm9DaGF0VXNlciA/ICduby1jaGF0LXVzZXInOiAnJ31cclxuICAgICAgICAgICAgICAgIGB9PlxyXG4gICAgICAgICAgICAgICAge3RoaXMuc3RhdGUuc2tlbGV0b25Mb2FkaW5nICYmICF0aGlzLnN0YXRlLm5vQ2hhdFVzZXIgP1xyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBBcnJheSg2KS5maWxsKCcnKS5tYXAoKF8sIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2Bza2VsZXRvbi1jb250YWluZXItbWVzc2FnZXMgJHtpICUgMiAhPT0gMCA/ICdvZGQtY29udGFpbmVyLXNrZWxldG9uJyA6ICcnfWB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17aSArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnNsaWNlKDIsIDYpfSBzdHlsZT17e29wYWNpdHk6ICg2IC0gaSkgKiAwLjEwfX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTa2VsZXRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9XCIzNXB4XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodD1cIjM1cHhcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luPXtbJzVweCcsICcxMHB4JywgJzBweCcsICcxMHB4J119XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM9XCI1MCVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxpbmUtd3JhcFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFNrZWxldG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9XCI1NSVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodD1cIjUycHhcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbj17Wyc1cHgnLCAnMHB4JywgJzBweCcsIGkgJSAyICE9PSAwID8gJ2F1dG8nIDogJzBweCddfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1cz1cIjAlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aSAlIDIgIT09IDAgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTa2VsZXRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD1cIjU1JVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodD1cIjUycHhcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW49e1snNXB4JywgJzBweCcsICcwcHgnLCAnYXV0byddfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM9XCIwJVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz46ICcnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIDogdGhpcy5zdGF0ZS5zdGFydE1lc3NhZ2VOb3RpZnkgPyA8ZGl2IGNsYXNzTmFtZT1cInNlbmQtZmlyc3QtbWVzc2FnZVwiPnt0aGlzLnN0YXRlLnN0YXJ0TWVzc2FnZU5vdGlmeX08L2Rpdj46XHJcbiAgICAgICAgICAgICAgICAgICAgIXRoaXMuc3RhdGUubm9DaGF0VXNlciAmJlxyXG4gICAgICAgICAgICAgICAgICAgIDxQcml2YXRlTWVzc2FnZUNvbnRlbnQgbWVzc2FnZXNIYXZlQmVlbkRlbGV0ZWQ9e3RoaXMuX19tZXNzYWdlc0hhdmVCZWVuRGVsZXRlZH0gLz5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHshdGhpcy5zdGF0ZS5za2VsZXRvbkxvYWRpbmcgJiYgPFRleHRBcmVhTWVzc2FnZVxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZVVzZXI9e3RoaXMucHJvcHMuYWN0aXZlVXNlcn1cclxuICAgICAgICAgICAgICAgICAgICBsb2dnZWRVc2VySWQ9e3RoaXMucHJvcHMubG9nZ2VkVXNlcj8uaWR9XHJcbiAgICAgICAgICAgICAgICAgICAgaXNUeXBpbmc9e3RoaXMuX19pc1R5cGluZ31cclxuICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZT17dGhpcy5fX3NlbmRNZXNzYWdlfS8+fVxyXG5cclxuICAgICAgICAgICAgICAgIDxNb2RhbFxyXG4gICAgICAgICAgICAgICAgICAgIHNob3c9e3RoaXMuc3RhdGUuc2hvd01vZGFsfVxyXG4gICAgICAgICAgICAgICAgICAgIGJlZm9yZUNsb3NlPXt0aGlzLnN0YXRlLmJlZm9yZUNsb3NlfVxyXG4gICAgICAgICAgICAgICAgICAgIGNsb3NlPXt0aGlzLl9fY2xvc2VNb2RhbH0+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzY3JvbGwtY29udGVudFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8aDI+UGxlYXNlIGNvbmZpcm0gbWVzc2FnZTwvaDI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxoND5Zb3VyIGluY2x1ZGVkIHRleHQ8L2g0PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJtZXNzYWdlLXBcIj57dGhpcy5zdGF0ZS5tb2RhbERhdGEueW91ck1lc3NhZ2V9PC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8aDQ+RW5jcnlwdGVkIHRleHQ8L2g0PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5tb2RhbERhdGEud2FybmluZ01zZyA/IDxwIGNsYXNzTmFtZT1cIndhcm5pbmctbWVzc2FnZVwiPnt0aGlzLnN0YXRlLm1vZGFsRGF0YS53YXJuaW5nTXNnfTwvcD46XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJtZXNzYWdlLXBcIj57dGhpcy5zdGF0ZS5tb2RhbERhdGEuZW5jcnlwdFRleHR9PC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPFVJX0VMRU1FTlRTLkJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kPVwiIzM3NDE1Y1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yPVwiI2ZmZlwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplPXsxMX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ9eydTZW5kJ31cclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9ezEwMH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luPXtbJzIwcHgnLCAnMCcsICcwJywgJ2F1dG8nXX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fX2hhbmRsZVN1Y2Nlc3N9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCJzbVwiLz5cclxuICAgICAgICAgICAgICAgIDwvTW9kYWw+XHJcbiAgICAgICAgICAgICAgICA8c3R5bGUganN4ID57YFxyXG4gICAgICAgICAgICAgICAgICAgIC5zY3JvbGwtY29udGVudCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heC1oZWlnaHQ6IDcwdmg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJmbG93LXg6IGhpZGRlbjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLm1lc3NhZ2UtcCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLndhcm5pbmctbWVzc2FnZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAjZmZhMTAwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAuc2tlbGV0b24tY29udGFpbmVyLW1lc3NhZ2VzIC5saW5lLXdyYXAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogY2FsYygxMDAlIC0gNzBweCk7ICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7ICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLm9kZC1jb250YWluZXItc2tlbGV0b24ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogcm93LXJldmVyc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC5za2VsZXRvbi1jb250YWluZXItbWVzc2FnZXMge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAubWVzc2FnZS1jb250ZW50LXJpZ2h0LmhpZGRlbi1vdmVybGF5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLm1lc3NhZ2UtY29udGVudC1yaWdodC5za2VsZXRvbi1sb2FkaW5nLWNvbnRlbnQge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtc3RhcnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC5tZXNzYWdlLWNvbnRlbnQtcmlnaHQge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGNhbGMoMTAwJSAtIDQycHgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC5lbXB0eS1tZXNzYWdlLWNvbnRlbnQge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAuc2VuZC1maXJzdC1tZXNzYWdlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250LXNpemU6IDIwcHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDE2cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC5uby1jaGF0LXVzZXIge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJy4vYXNzZXRzL2ltYWdlcy9ub2NoYXQucG5nJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogLjI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYH08L3N0eWxlPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApXHJcbiAgICB9XHJcbn1cclxuXHJcbmNvbnN0IG1hcFN0YXRlVG9Qcm9wcyA9IHN0YXRlID0+ICh7XHJcbiAgICBsb2dnZWRVc2VyOiBzdGF0ZS5jaGF0LmxvZ2dlZFVzZXIsXHJcbiAgICBhY3RpdmVVc2VyOiBzdGF0ZS5jaGF0LmFjdGl2ZVVzZXIsXHJcbiAgICB1c2Vyc0xpc3Q6IHN0YXRlLmNoYXQubXlDaGF0VXNlcnMsXHJcbiAgICBpc1Nob3dNb2RhbDogc3RhdGUuY2hhdC5pc1Nob3dNb2RhbCxcclxuICAgIGVuY3J5cHREYXRhOiBzdGF0ZS5jaGF0LmVuY3J5cHREYXRhLFxyXG4gICAgbWVzc2FnZXM6IHN0YXRlLmNoYXQuYWN0aXZlVXNlck1lc3NhZ2VzLFxyXG59KTtcclxuXHJcbmNvbnN0IG1hcERpc3BhdGNoVG9Qcm9wcyA9IHtcclxuICAgIF9fU0VUX0VOQ1JZUFRfREFUQSxcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QoXHJcbiAgICBtYXBTdGF0ZVRvUHJvcHMsXHJcbiAgICBtYXBEaXNwYXRjaFRvUHJvcHNcclxuKShNZXNzYWdlcyk7XHJcbiJdfQ== */\\n/*@ sourceURL=C:\\\\\\\\Users\\\\\\\\ruala\\\\\\\\Desktop\\\\\\\\ASahak\\\\\\\\daser\\\\\\\\next\\\\\\\\CryptoGraphy\\\\\\\\components\\\\\\\\Messages.jsx */\"));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  loggedUser: state.chat.loggedUser,\n  activeUser: state.chat.activeUser,\n  usersList: state.chat.myChatUsers,\n  isShowModal: state.chat.isShowModal,\n  encryptData: state.chat.encryptData,\n  messages: state.chat.activeUserMessages\n});\n\nconst mapDispatchToProps = {\n  __SET_ENCRYPT_DATA\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Messages);","map":{"version":3,"sources":["C:/Users/ruala/Desktop/ASahak/daser/next/CryptoGraphy/components/Messages.jsx"],"names":["React","connect","__GET_ACTIVE_USERS_MESSAGES","__ADD_MESSAGE","__GET_CHAT_USERS","__IS_TYPING_TO_ACTIVE_USER","__EDIT_MESSAGE","__SET_ENCRYPT_DATA","TextAreaMessage","Skeleton","PrivateMessageContent","Modal","UI_ELEMENTS","Bus","Vigenere","RSA","Caesar","Playfair","Vernam","Substitution","Messages","Component","constructor","props","state","startMessageNotify","skeletonLoading","noChatUser","activeUserData","showModal","beforeClose","sendMessage","modalData","yourMessage","encryptText","warningMsg","__sendMessage","bind","__isTyping","__handleSuccess","__closeModal","__handleSubmitMessage","__updateStateContent","__messagesHaveBeenDeleted","componentDidUpdate","prevProps","prevState","snapshot","usersList","length","setState","activeUser","id","startTime","Date","getTime","genMessages","next","endTime","value","letters","message","messages","setTimeout","hint","loggedUser","decryptText","encryptedMsg","decryptMsg","isKey","isNaN","messageData","time","decryptedMsg","key","encryptData","encryptType","type","friend","friendId","msgData","owner","my","dispatch","__encryptCommon","callback","sendMSG","encryptedMsgV","doCryptVigenere","msg","encryptedMSG","decryptedMSG","encryptedMsgS","encrypt","decrypt","keys","generate","encoded_message","encode","encrypted_message","n","e","decrypted_message","d","decoded_message","decode","toString","encryptedMsgC","doCrypt","doCipher","deCodeCipher","_keyE","encryptedMsgVer","doEncrypt","_key","doDecrypt","Object","call","mainObj","index","idUser","myId","warning","encryptMsg","isShowModal","render","Array","fill","map","_","i","Math","random","slice","opacity","mapStateToProps","chat","myChatUsers","activeUserMessages","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n    __GET_ACTIVE_USERS_MESSAGES,\r\n    __ADD_MESSAGE,\r\n    __GET_CHAT_USERS,\r\n    __IS_TYPING_TO_ACTIVE_USER,\r\n    __EDIT_MESSAGE,\r\n} from 'store/saga';\r\nimport {\r\n    __SET_ENCRYPT_DATA,\r\n} from 'store/actions';\r\nimport TextAreaMessage from 'components/elements/TextAreaMessage';\r\nimport Skeleton from \"./Skeleton\";\r\nimport PrivateMessageContent from \"components/elements/PrivateMessageContent\";\r\nimport { Modal } from 'components/shared/UI/Modal';\r\nimport UI_ELEMENTS from \"./shared/UI\";\r\nimport { Bus } from \"components/shared/helpers/Bus\";\r\nimport {\r\n    Vigenere,\r\n    RSA,\r\n    Caesar,\r\n    Playfair,\r\n    Vernam,\r\n    Substitution,\r\n} from 'libraries';\r\n\r\n\r\nclass Messages extends React.Component {\r\n    constructor (props) {\r\n        super(props);\r\n        this.state = {\r\n            startMessageNotify: '',\r\n            skeletonLoading: true,\r\n            noChatUser: false,\r\n            activeUserData: {},\r\n            showModal: false,\r\n            beforeClose: false,\r\n            sendMessage: '',\r\n            modalData: {\r\n                yourMessage: '',\r\n                encryptText: '',\r\n                warningMsg: '',\r\n            }\r\n        };\r\n        this.__sendMessage              = this.__sendMessage.bind(this);\r\n        this.__isTyping                 = this.__isTyping.bind(this);\r\n        this.__handleSuccess            = this.__handleSuccess.bind(this);\r\n        this.__closeModal               = this.__closeModal.bind(this);\r\n        this.__handleSubmitMessage      = this.__handleSubmitMessage.bind(this);\r\n        this.__updateStateContent       = this.__updateStateContent.bind(this);\r\n        this.__messagesHaveBeenDeleted  = this.__messagesHaveBeenDeleted.bind(this);\r\n    }\r\n\r\n    async componentDidUpdate(prevProps, prevState, snapshot) {\r\n        // Working when my chat list is empty\r\n        if (!this.state.noChatUser && this.props.usersList && this.props.usersList.length === 0) {\r\n            this.setState({\r\n                noChatUser: true\r\n            })\r\n        } else if (this.state.noChatUser && this.props.usersList && this.props.usersList.length !== 0) {\r\n            this.setState({\r\n                noChatUser: false\r\n            })\r\n        }\r\n        if (!prevProps.activeUser?.id && this.props.activeUser?.id && prevProps.activeUser?.id !== this.props.activeUser?.id) {\r\n            this.setState({\r\n                startMessageNotify: '',\r\n                skeletonLoading: true\r\n            });\r\n            const startTime = new Date().getTime();\r\n            const genMessages = await __GET_ACTIVE_USERS_MESSAGES(this.props.activeUser?.id).next();\r\n            const endTime = new Date().getTime();\r\n            this.__updateStateContent(genMessages.value.letters[0].message, endTime, startTime);\r\n        } else if (prevProps.activeUser?.id !== this.props.activeUser?.id && this.props.activeUser?.id) {\r\n            this.setState({\r\n                startMessageNotify: '',\r\n                skeletonLoading: true\r\n            });\r\n            const startTime = new Date().getTime();\r\n            const genMessages = await __GET_ACTIVE_USERS_MESSAGES(this.props.activeUser?.id).next();\r\n            const endTime = new Date().getTime();\r\n\r\n            this.__updateStateContent(genMessages.value.letters[0].message, endTime, startTime);\r\n        } else if (prevProps.messages.length === 1 && prevProps.messages[0].message === '' && this.props.messages.length === 1 && this.props.messages[0].message !== '') {\r\n            this.setState({\r\n                startMessageNotify: '',\r\n            });\r\n        }\r\n    }\r\n\r\n    __messagesHaveBeenDeleted () {\r\n        this.setState({\r\n            startMessageNotify: 'Send the first letter'\r\n        })\r\n    }\r\n\r\n    __updateStateContent (message, endTime, startTime) {\r\n        this.setState({//If there aren't any messages\r\n            ...(message === '' && {startMessageNotify: 'Send the first letter'})\r\n        });\r\n\r\n        if (endTime - startTime < 1000) {\r\n            setTimeout(() => {\r\n                this.setState({\r\n                    noChatUser: false,\r\n                    skeletonLoading: false,\r\n                })\r\n            }, 1000)\r\n        } else {\r\n            this.setState({\r\n                noChatUser: false,\r\n                skeletonLoading: false,\r\n            })\r\n        }\r\n    }\r\n\r\n    __isTyping (hint) {\r\n        __IS_TYPING_TO_ACTIVE_USER(hint, this.props.activeUser?.id, this.props.loggedUser.id).next()\r\n    }\r\n\r\n    __handleSuccess () {\r\n        this.setState({\r\n            beforeClose: true\r\n        });\r\n    }\r\n\r\n    __closeModal () {\r\n        this.setState({\r\n            beforeClose: false,\r\n            showModal: false\r\n        }, () => {\r\n            if (this.state.modalData.encryptText) this.__handleSubmitMessage(this.state.sendMessage, this.state.modalData.encryptText, this.state.modalData.decryptText);\r\n        });\r\n    }\r\n\r\n    async __handleSubmitMessage (value, encryptedMsg, decryptMsg) {\r\n        const isKey = (value === 'crypt' && value === encryptedMsg && value === decryptMsg && (isNaN(decryptMsg)));\r\n        const messageData = {\r\n            time: new Date().getTime(),\r\n            message: value,\r\n            encryptedMsg: encryptedMsg,\r\n            decryptedMsg: decryptMsg,\r\n            key: isKey ? 'crypt' : this.props.encryptData?.key,\r\n            encryptType: isKey ? 'crypt' : this.props.encryptData.type\r\n        };\r\n\r\n        await __ADD_MESSAGE({\r\n            friend: {\r\n                friendId: this.props.activeUser?.id,\r\n                loggedUser: this.props.loggedUser,\r\n                msgData: {...messageData, owner: this.props.loggedUser.id}\r\n            },\r\n            my: {\r\n                friendId: this.props.activeUser?.id,\r\n                loggedUser: this.props.loggedUser,\r\n                msgData: {...messageData, owner: 'Me'}\r\n            }\r\n        }).next();\r\n\r\n        __GET_CHAT_USERS().next();\r\n        this.setState({\r\n            startMessageNotify: ''\r\n        });\r\n        Bus.dispatch('messageSendingFinish');\r\n    }\r\n\r\n    __encryptCommon (value, key, type, callback = () => {}) {\r\n        let sendMSG = {};\r\n        switch (type) {\r\n            case 'vigenere':\r\n                const encryptedMsgV = Vigenere.doCryptVigenere(false, value, key, (msg) => {\r\n                    callback(msg);\r\n                    this.props.__SET_ENCRYPT_DATA({type: 'warning', value: true});\r\n                });\r\n                return sendMSG = {\r\n                    encryptedMSG: encryptedMsgV,\r\n                    decryptedMSG: Vigenere.doCryptVigenere(true, encryptedMsgV, key, (msg) => {\r\n                        callback(msg);\r\n                        this.props.__SET_ENCRYPT_DATA({type: 'warning', value: true});\r\n                    }),\r\n                };\r\n            case 'substitution' :\r\n                const encryptedMsgS = Substitution(value);\r\n                return sendMSG = {\r\n                    encryptedMSG: encryptedMsgS.encrypt,\r\n                    decryptedMSG: encryptedMsgS.decrypt\r\n                };\r\n            case 'rsa' :\r\n                // Message\r\n                const message = value;\r\n\r\n                // Generate RSA keys\r\n                const keys = RSA.generate(key);\r\n\r\n                const encoded_message = RSA.encode(message);\r\n                const encrypted_message = RSA.encrypt(encoded_message, keys.n, keys.e);\r\n                const decrypted_message = RSA.decrypt(encrypted_message, keys.d, keys.n);\r\n                const decoded_message = RSA.decode(decrypted_message);\r\n\r\n                return sendMSG = {\r\n                    encryptedMSG: encoded_message.toString(),\r\n                    decryptedMSG: decoded_message\r\n                };\r\n            case 'caesar':\r\n                const encryptedMsgC = Caesar.doCrypt(false, value, key, (msg) => {\r\n                    callback(msg);\r\n                });\r\n                return sendMSG = {\r\n                    encryptedMSG: encryptedMsgC,\r\n                    decryptedMSG: Caesar.doCrypt(true, encryptedMsgC, key, (msg) => {\r\n                        callback(msg);\r\n                    })\r\n                };\r\n            case 'playfair':\r\n                return sendMSG = {\r\n                    encryptedMSG: Playfair.doCipher(value, key, (msg) => {\r\n                        callback(msg);\r\n                    }),\r\n                    decryptedMSG: Playfair.deCodeCipher(value, key)\r\n                };\r\n            case 'vernam':\r\n                let _keyE = '';\r\n                const encryptedMsgVer = Vernam.doEncrypt(value, (_key) => {\r\n                    _keyE = _key;\r\n                    this.props.__SET_ENCRYPT_DATA({type: 'key', value: _key})\r\n                });\r\n\r\n                return sendMSG = {\r\n                    encryptedMSG: encryptedMsgVer,\r\n                    decryptedMSG: Vernam.doDecrypt(value, _keyE)\r\n                };\r\n            default : break;\r\n        }\r\n    }\r\n\r\n    async __sendMessage (value, isKey) {\r\n        if (isKey instanceof Object) {\r\n            const encryptedMsg = this.__encryptCommon.call(this, value, isKey.mainObj?.key, isKey.mainObj?.encryptType);\r\n            await __EDIT_MESSAGE(\r\n                {value, e: encryptedMsg.encryptedMSG, d: encryptedMsg.decryptedMSG},\r\n                isKey?.index,\r\n                {idUser: this.props.activeUser?.id, myId: this.props.loggedUser?.id}).next();\r\n            Bus.dispatch('endEditing');\r\n            Bus.dispatch('messageSendingFinish');\r\n            return\r\n        } else if (isKey) {\r\n            this.__handleSubmitMessage('crypt', 'crypt', 'crypt');\r\n            return\r\n        }\r\n        let warning = '';\r\n        this.setState({\r\n            sendMessage: value\r\n        }, () => {\r\n            const encryptMsg = this.__encryptCommon.call(this, value, this.props.encryptData?.key, this.props.encryptData.type, (msg) => {\r\n                warning = msg;\r\n            });\r\n            if (this.props.isShowModal) {\r\n                this.setState({\r\n                    modalData: {\r\n                        yourMessage: value,\r\n                        ...(warning && {warningMsg: warning}),\r\n                        ...(encryptMsg.encryptedMSG && {encryptText: encryptMsg.encryptedMSG}),\r\n                        ...(encryptMsg.decryptedMSG && {decryptText: encryptMsg.decryptedMSG}),\r\n                    },\r\n                    showModal: true\r\n                });\r\n            } else if (encryptMsg.encryptedMSG && encryptMsg.decryptedMSG) this.__handleSubmitMessage(value, encryptMsg.encryptedMSG, encryptMsg.decryptedMSG);\r\n        });\r\n    }\r\n\r\n    render () {\r\n        return (\r\n            <div\r\n                className={`message-content-right \r\n                ${this.state.skeletonLoading ? 'skeleton-loading-content' : ''} \r\n                ${!this.state.noChatUser ? 'hidden-overlay' : ''} \r\n                ${this.state.startMessageNotify ? 'empty-message-content' : ''}\r\n                ${this.state.noChatUser ? 'no-chat-user': ''}\r\n                `}>\r\n                {this.state.skeletonLoading && !this.state.noChatUser ?\r\n                    new Array(6).fill('').map((_, i) => {\r\n                            return (\r\n                                <div\r\n                                    className={`skeleton-container-messages ${i % 2 !== 0 ? 'odd-container-skeleton' : ''}`}\r\n                                    key={i + Math.random().toString(16).slice(2, 6)} style={{opacity: (6 - i) * 0.10}}>\r\n                                    <Skeleton\r\n                                        width=\"35px\"\r\n                                        height=\"35px\"\r\n                                        margin={['5px', '10px', '0px', '10px']}\r\n                                        radius=\"50%\"\r\n                                    />\r\n                                    <div className=\"line-wrap\">\r\n                                        <Skeleton\r\n                                            width=\"55%\"\r\n                                            height=\"52px\"\r\n                                            margin={['5px', '0px', '0px', i % 2 !== 0 ? 'auto' : '0px']}\r\n                                            radius=\"0%\"\r\n                                        />\r\n                                        {i % 2 !== 0 ?\r\n                                            <Skeleton\r\n                                                width=\"55%\"\r\n                                                height=\"52px\"\r\n                                                margin={['5px', '0px', '0px', 'auto']}\r\n                                                radius=\"0%\"\r\n                                            />: ''\r\n                                        }\r\n                                    </div>\r\n                                </div>\r\n                            )\r\n                        })\r\n                    : this.state.startMessageNotify ? <div className=\"send-first-message\">{this.state.startMessageNotify}</div>:\r\n                    !this.state.noChatUser &&\r\n                    <PrivateMessageContent messagesHaveBeenDeleted={this.__messagesHaveBeenDeleted} />\r\n                }\r\n                {!this.state.skeletonLoading && <TextAreaMessage\r\n                    activeUser={this.props.activeUser}\r\n                    loggedUserId={this.props.loggedUser?.id}\r\n                    isTyping={this.__isTyping}\r\n                    sendMessage={this.__sendMessage}/>}\r\n\r\n                <Modal\r\n                    show={this.state.showModal}\r\n                    beforeClose={this.state.beforeClose}\r\n                    close={this.__closeModal}>\r\n                    <div className=\"scroll-content\">\r\n                        <h2>Please confirm message</h2>\r\n                        <h4>Your included text</h4>\r\n                        <p className=\"message-p\">{this.state.modalData.yourMessage}</p>\r\n                        <h4>Encrypted text</h4>\r\n                        {this.state.modalData.warningMsg ? <p className=\"warning-message\">{this.state.modalData.warningMsg}</p>:\r\n                            <p className=\"message-p\">{this.state.modalData.encryptText}</p>\r\n                        }\r\n                    </div>\r\n                    <UI_ELEMENTS.Button\r\n                        background=\"#37415c\"\r\n                        color=\"#fff\"\r\n                        fontSize={11}\r\n                        type=\"button\"\r\n                        text={'Send'}\r\n                        width={100}\r\n                        margin={['20px', '0', '0', 'auto']}\r\n                        onClick={this.__handleSuccess}\r\n                        size=\"sm\"/>\r\n                </Modal>\r\n                <style jsx >{`\r\n                    .scroll-content {\r\n                        max-height: 70vh;\r\n                        overflow-x: hidden;\r\n                    }\r\n                    .message-p {\r\n                        word-break: break-all;\r\n                    }\r\n                    .warning-message {\r\n                        color: #ffa100;\r\n                    }\r\n                    .skeleton-container-messages .line-wrap {\r\n                        width: calc(100% - 70px);   \r\n                        margin-bottom: 10px;                 \r\n                    }\r\n                    .odd-container-skeleton {\r\n                        flex-direction: row-reverse;\r\n                    }\r\n                    .skeleton-container-messages {\r\n                        display: flex;\r\n                    }\r\n                    .message-content-right.hidden-overlay {\r\n                        overflow: hidden;\r\n                    }\r\n                    .message-content-right.skeleton-loading-content {\r\n                        overflow: hidden;\r\n                        justify-content: flex-start;\r\n                    }\r\n                    .message-content-right {\r\n                        height: calc(100% - 42px);\r\n                        display: flex;\r\n                        flex-direction: column;\r\n                        justify-content: space-between;\r\n                    }\r\n                    .empty-message-content {\r\n                        justify-content: flex-end;\r\n                    }\r\n                    .send-first-message {\r\n                        text-align: center;\r\n                        font-size: 20px;\r\n                        margin-bottom: 16px;\r\n                    }\r\n                    .no-chat-user {\r\n                        background-image: url('./assets/images/nochat.png');\r\n                        background-position: center;\r\n                        background-repeat: no-repeat;\r\n                        opacity: .2;\r\n                    }\r\n                `}</style>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    loggedUser: state.chat.loggedUser,\r\n    activeUser: state.chat.activeUser,\r\n    usersList: state.chat.myChatUsers,\r\n    isShowModal: state.chat.isShowModal,\r\n    encryptData: state.chat.encryptData,\r\n    messages: state.chat.activeUserMessages,\r\n});\r\n\r\nconst mapDispatchToProps = {\r\n    __SET_ENCRYPT_DATA,\r\n};\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(Messages);\r\n"]},"metadata":{},"sourceType":"module"}